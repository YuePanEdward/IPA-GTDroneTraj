function [D, Hz, V] = getMeasurments(TPSport, distmode)
% Set tolerances
%     if ~isempty(distmode)
%         req=['%R1Q,17017:', num2str(distmode)];
%         fprintf (TPSport, req);
%         out = fscanf (TPSport);
%         data = regexp(out,':(?<RC>[^,]*),(?<Hz>[^,]*),(?<V>[^,]*),(?<D>[^,]*)','names');
%     end
% Request - send a command to get a simple angle measurement
    if ~isempty(distmode)   
        fprintf('\nTMC_GetAngle5 - returning angles and distance measurement\n');
        req=['%R1Q,17017:', num2str(distmode)];
        fprintf (TPSport, req); 

% Reply - read response data into the sting-variable out
        out = fscanf (TPSport);

% Extract the returned values
       data = regexp(out,':(?<RC>[^,]*),(?<Hz>[^,]*),(?<V>[^,]*),(?<D>[^,]*)','names');

% Check output and store result
        if (str2num(data.RC) == 0)
            Hz = str2double (data.Hz);
            V = str2double (data.V); 
            D = str2double (data.D);

% Print the values
%           fprintf('Hz = %.4f [gon]; V = %.4f [gon]; D = %.4f [m]\n', Hz *
%           200/pi, V * 200/pi, D); % in gong
fprintf('D = %.4f [m]; Hz = %.4f [deg]; V = %.4f [deg]\n',D, Hz*
           200/pi, V * 200/pi, D);
        else
            fprintf('GRC_Return-Code= %.0f; Check the GRC return-code in manual!\n', data.RC)
        end
    end
end